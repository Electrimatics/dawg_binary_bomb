#include <stdio.h>
#include <stdint.h>
#include <string.h>
#include <time.h>
#include <stdlib.h>
char* dummy(char* flag, int debugger);

char* dummy(char* flag, int debugger) {
    //Spr1nKL3_Of_ChOcoL4Te
    //  S       p       r       1       n       K       L       3       _       O
    //  0       1       2       3       4       5       6       7       8       9
    //  0x53    0x70    0x72    0x31    0x6e    0x4b    0x4c    0x33    0x5f    0x4f    
    //
    //  f       _       C       h       O       c       o       L       4       T       e
    //  10      11      12      13      14      15      16      17      18      19      20     
    //  0x66    0x5f    0x43    0x68    0x4f    0x63    0x6f    0x4c    0x34    0x54    0x65
    /*
        flag[5] = 0x73+debugger;
        flag[14] = 0x3;	
        uint8_t base1 = 0x35+debugger;	
        flag[12] = 0x27;	
        flag[9] = 0x5f+debugger;
        uint8_t base2 = 0x76+debugger;
        uint8_t half1 = 0xf0 & flag[5];
        flag[5] = (flag[5] << 4) | (half1 >> 4);
        flag[10] = base1;	
        flag[15] = 0x35;
        flag[3] = base2;	
        flag[17] = 0x64;
        flag[6] = 0x62;		
        flag[20] = 0x5f+debugger+debugger;
        flag[12] = flag[12] ^ 0x55;
        flag[0] = 0x30;		
        flag[4] = 0x75;
        uint8_t half2 = 0xf0 & flag[17];
        flag[17] = (flag[17] << 4) | (half2 >> 4);
        flag[3]-= 0x13+debugger;
        flag[22] = 0x55;
        flag[1] = 0x23;		
        flag[21] = 0x66;
        flag[1]+=base1;
        flag[18] = 0x30;
        flag[16] = 0x3c;
        flag[14] += base2;
        flag[0]+=3;	
        uint8_t half3 = 0xf0 & flag[21];
        flag[21] = (flag[21] << 4) | (half3 >> 4);
        flag[23] = 0x4c;
        flag[6] = flag[6] >> 1;	
        flag[7] = 0x6e;
        flag[13] = 0x41;
        flag[19] = 0x26;	
        flag[23] = flag[23] ^ 0x22+debugger;
        flag[2] = 0x11;		
        flag[24] = '\0';
        flag[19]*=(0x3+debugger);
        flag[11] = 0x52;
        flag[2]*=(0x3+debugger);
        flag[16] = flag[16] ^ 0x63+debugger;
        flag[10]-=1;
        flag[8] = 0x23;
        flag[8]*=0x2;	
        flag[8]+=0x1;
    */

   uint8_t base1 = 0x4f+debugger;
uint8_t base2 = 0x34+debugger;

flag[0]=0x50;
flag[0]+=3;
flag[1]=0x70+debugger;
flag[2]=0x26;
flag[2]*=0x3;
flag[3]=base2-0x3;
flag[4]=0x69;
flag[4]=flag[4]^0x7;
flag[5]=0x4b;
flag[6]=0x4c+debugger;
flag[7]=0x33;
flag[8]=base1+0x10;
flag[9]=base1;
flag[10]=0x17;
flag[10]+= base1;
flag[11]=0x5f+debugger;
flag[12]=0x43;
flag[13]=0x19;
flag[13]+=base1;
flag[14]=0x4f;
flag[15]=0x63+debugger;
flag[16]=base1+0x20;
flag[17]=0x3c;
flag[17]+=0x10;
flag[18]=base2;
flag[19]=0x54+debugger;
flag[20]=0x65+debugger;
flag[21] = '\0';
    return flag;
}

int main() {
    char flag[21];
    char* answer = dummy(flag, 0);
    printf("%s\n", answer);

    unsigned char code[] = {0xf3,0x0f,0x1e,0xfa,0x55,0x48,0x89,0xe5,0x48,0x89,0x7d,0xe8,0x89,0x75,0xe4,0x8b,0x45,0xe4,0x83,0xc0,0x4f,0x88,0x45,0xfe,0x8b,0x45,0xe4,0x83,0xc0,0x34,0x88,0x45,0xff,0x48,0x8b,0x45,0xe8,0xc6,0x00,0x50,0x48,0x8b,0x45,0xe8,0x0f,0xb6,0x00,0x83,0xc0,0x03,0x89,0xc2,0x48,0x8b,0x45,0xe8,0x88,0x10,0x8b,0x45,0xe4,0x8d,0x50,0x70,0x48,0x8b,0x45,0xe8,0x48,0x83,0xc0,0x01,0x88,0x10,0x48,0x8b,0x45,0xe8,0x48,0x83,0xc0,0x02,0xc6,0x00,0x26,0x48,0x8b,0x45,0xe8,0x48,0x83,0xc0,0x02,0x0f,0xb6,0x00,0x89,0xc2,0x89,0xd0,0x01,0xc0,0x01,0xc2,0x48,0x8b,0x45,0xe8,0x48,0x83,0xc0,0x02,0x88,0x10,0x0f,0xb6,0x45,0xff,0x8d,0x50,0xfd,0x48,0x8b,0x45,0xe8,0x48,0x83,0xc0,0x03,0x88,0x10,0x48,0x8b,0x45,0xe8,0x48,0x83,0xc0,0x04,0xc6,0x00,0x69,0x48,0x8b,0x45,0xe8,0x48,0x83,0xc0,0x04,0x0f,0xb6,0x10,0x48,0x8b,0x45,0xe8,0x48,0x83,0xc0,0x04,0x83,0xf2,0x07,0x88,0x10,0x48,0x8b,0x45,0xe8,0x48,0x83,0xc0,0x05,0xc6,0x00,0x4b,0x8b,0x45,0xe4,0x8d,0x50,0x4c,0x48,0x8b,0x45,0xe8,0x48,0x83,0xc0,0x06,0x88,0x10,0x48,0x8b,0x45,0xe8,0x48,0x83,0xc0,0x07,0xc6,0x00,0x33,0x0f,0xb6,0x45,0xfe,0x8d,0x50,0x10,0x48,0x8b,0x45,0xe8,0x48,0x83,0xc0,0x08,0x88,0x10,0x48,0x8b,0x45,0xe8,0x48,0x8d,0x50,0x09,0x0f,0xb6,0x45,0xfe,0x88,0x02,0x48,0x8b,0x45,0xe8,0x48,0x83,0xc0,0x0a,0xc6,0x00,0x17,0x48,0x8b,0x45,0xe8,0x48,0x83,0xc0,0x0a,0x0f,0xb6,0x00,0x89,0xc2,0x0f,0xb6,0x45,0xfe,0x01,0xc2,0x48,0x8b,0x45,0xe8,0x48,0x83,0xc0,0x0a,0x88,0x10,0x8b,0x45,0xe4,0x8d,0x50,0x5f,0x48,0x8b,0x45,0xe8,0x48,0x83,0xc0,0x0b,0x88,0x10,0x48,0x8b,0x45,0xe8,0x48,0x83,0xc0,0x0c,0xc6,0x00,0x43,0x48,0x8b,0x45,0xe8,0x48,0x83,0xc0,0x0d,0xc6,0x00,0x19,0x48,0x8b,0x45,0xe8,0x48,0x83,0xc0,0x0d,0x0f,0xb6,0x00,0x89,0xc2,0x0f,0xb6,0x45,0xfe,0x01,0xc2,0x48,0x8b,0x45,0xe8,0x48,0x83,0xc0,0x0d,0x88,0x10,0x48,0x8b,0x45,0xe8,0x48,0x83,0xc0,0x0e,0xc6,0x00,0x4f,0x8b,0x45,0xe4,0x8d,0x50,0x63,0x48,0x8b,0x45,0xe8,0x48,0x83,0xc0,0x0f,0x88,0x10,0x0f,0xb6,0x45,0xfe,0x8d,0x50,0x20,0x48,0x8b,0x45,0xe8,0x48,0x83,0xc0,0x10,0x88,0x10,0x48,0x8b,0x45,0xe8,0x48,0x83,0xc0,0x11,0xc6,0x00,0x3c,0x48,0x8b,0x45,0xe8,0x48,0x83,0xc0,0x11,0x0f,0xb6,0x00,0x8d,0x50,0x10,0x48,0x8b,0x45,0xe8,0x48,0x83,0xc0,0x11,0x88,0x10,0x48,0x8b,0x45,0xe8,0x48,0x8d,0x50,0x12,0x0f,0xb6,0x45,0xff,0x88,0x02,0x8b,0x45,0xe4,0x8d,0x50,0x54,0x48,0x8b,0x45,0xe8,0x48,0x83,0xc0,0x13,0x88,0x10,0x8b,0x45,0xe4,0x8d,0x50,0x65,0x48,0x8b,0x45,0xe8,0x48,0x83,0xc0,0x14,0x88,0x10,0x48,0x8b,0x45,0xe8,0x48,0x83,0xc0,0x15,0xc6,0x00,0x00,0x48,0x8b,0x45,0xe8,0x5d,0xc3};

    srand(time(NULL));
    for(int i = 0; i < 10; i++) {
        for(int j = 0; j < 30; j++) {
            printf("%d ", (rand()%16)+1);
        }
        printf("\n");
    }
    printf("{"); 
    for(int i = 0; i < sizeof(code); i++) {
        code[i] = code[i] - 0x5;
        uint8_t lower2 = 0xc0 & code[i];
        code[i] = (code[i] << 2) | (lower2 >> 6);
        printf("0x%x,", 0xff & code[i]);
    }
    printf("};\n");
    return 0;
}