#include <stdio.h>
#include <stdint.h>

void dummy(char* flag, int debugger) {
    flag[13] = 0x02;
    flag[0] = 0x21;
    flag[20] = 0xd0;
    flag[14] = 0xc3;
    flag[2] = 0xe3;
    flag[24] = 0xb2;
    flag[16] = 0xc4;
    flag[25] = 0x64;
    flag[11] = 0x14;
    flag[19] = 0x15;
    flag[10] = 0x01;
    flag[21] = 0x92;
    flag[18] = 0x03;
    flag[22] = 0xc3;
    flag[3] = 0xf2;
    flag[8] = 0x64;
    flag[17] = 0xc3;
    flag[27] = 0xe0;
    flag[5] = 0x11;
    flag[7] = 0xb2;
    flag[15] = 0x32;
    flag[4] = 0xf4;
    flag[9] = 0xc3;
    flag[1] = 0x63;
    flag[6] = 0xc3;
    flag[28] = 0x52;
    flag[23] = 0x42;
    flag[12] = 0xd0;
    flag[26] = 0x14;

    for(int ii = 0; ii < 29; ii++) {
        unsigned char half = (flag[ii] & 0xf0);
        flag[ii] = (flag[ii] << 4) | (half >> 4);
        flag[ii] += 0x23 + debugger;
    }
    
    for(int ii = 0; ii < 29/2; ii++) {
        flag[ii] ^= flag[29-1-ii];
        flag[29-1-ii] ^= flag[ii];
        flag[ii] ^= flag[29-1-ii];
    }
    
}

int main() {
    char flag[50] = {'\0'};
    dummy(flag, 0);
    printf("%s\n", flag);

    printf("{");
    unsigned char code[] = {0xf3, 0x0f, 0x1e, 0xfa, 0x55, 0x48, 0x89, 0xe5, 0x48, 0x89, 0x7d, 0xe8, 0x89, 0x75, 0xe4, 0x48, 0x8b, 0x45, 0xe8, 0x48, 0x83, 0xc0, 0x0d, 0xc6, 0x00, 0x02, 0x48, 0x8b, 0x45, 0xe8, 0xc6, 0x00, 0x21, 0x48, 0x8b, 0x45, 0xe8, 0x48, 0x83, 0xc0, 0x14, 0xc6, 0x00, 0xd0, 0x48, 0x8b, 0x45, 0xe8, 0x48, 0x83, 0xc0, 0x0e, 0xc6, 0x00, 0xc3, 0x48, 0x8b, 0x45, 0xe8, 0x48, 0x83, 0xc0, 0x02, 0xc6, 0x00, 0xe3, 0x48, 0x8b, 0x45, 0xe8, 0x48, 0x83, 0xc0, 0x18, 0xc6, 0x00, 0xb2, 0x48, 0x8b, 0x45, 0xe8, 0x48, 0x83, 0xc0, 0x10, 0xc6, 0x00, 0xc4, 0x48, 0x8b, 0x45, 0xe8, 0x48, 0x83, 0xc0, 0x19, 0xc6, 0x00, 0x64, 0x48, 0x8b, 0x45, 0xe8, 0x48, 0x83, 0xc0, 0x0b, 0xc6, 0x00, 0x14, 0x48, 0x8b, 0x45, 0xe8, 0x48, 0x83, 0xc0, 0x13, 0xc6, 0x00, 0x15, 0x48, 0x8b, 0x45, 0xe8, 0x48, 0x83, 0xc0, 0x0a, 0xc6, 0x00, 0x01, 0x48, 0x8b, 0x45, 0xe8, 0x48, 0x83, 0xc0, 0x15, 0xc6, 0x00, 0x92, 0x48, 0x8b, 0x45, 0xe8, 0x48, 0x83, 0xc0, 0x12, 0xc6, 0x00, 0x03, 0x48, 0x8b, 0x45, 0xe8, 0x48, 0x83, 0xc0, 0x16, 0xc6, 0x00, 0xc3, 0x48, 0x8b, 0x45, 0xe8, 0x48, 0x83, 0xc0, 0x03, 0xc6, 0x00, 0xf2, 0x48, 0x8b, 0x45, 0xe8, 0x48, 0x83, 0xc0, 0x08, 0xc6, 0x00, 0x64, 0x48, 0x8b, 0x45, 0xe8, 0x48, 0x83, 0xc0, 0x11, 0xc6, 0x00, 0xc3, 0x48, 0x8b, 0x45, 0xe8, 0x48, 0x83, 0xc0, 0x1b, 0xc6, 0x00, 0xe0, 0x48, 0x8b, 0x45, 0xe8, 0x48, 0x83, 0xc0, 0x05, 0xc6, 0x00, 0x11, 0x48, 0x8b, 0x45, 0xe8, 0x48, 0x83, 0xc0, 0x07, 0xc6, 0x00, 0xb2, 0x48, 0x8b, 0x45, 0xe8, 0x48, 0x83, 0xc0, 0x0f, 0xc6, 0x00, 0x32, 0x48, 0x8b, 0x45, 0xe8, 0x48, 0x83, 0xc0, 0x04, 0xc6, 0x00, 0xf4, 0x48, 0x8b, 0x45, 0xe8, 0x48, 0x83, 0xc0, 0x09, 0xc6, 0x00, 0xc3, 0x48, 0x8b, 0x45, 0xe8, 0x48, 0x83, 0xc0, 0x01, 0xc6, 0x00, 0x63, 0x48, 0x8b, 0x45, 0xe8, 0x48, 0x83, 0xc0, 0x06, 0xc6, 0x00, 0xc3, 0x48, 0x8b, 0x45, 0xe8, 0x48, 0x83, 0xc0, 0x1c, 0xc6, 0x00, 0x52, 0x48, 0x8b, 0x45, 0xe8, 0x48, 0x83, 0xc0, 0x17, 0xc6, 0x00, 0x42, 0x48, 0x8b, 0x45, 0xe8, 0x48, 0x83, 0xc0, 0x0c, 0xc6, 0x00, 0xd0, 0x48, 0x8b, 0x45, 0xe8, 0x48, 0x83, 0xc0, 0x1a, 0xc6, 0x00, 0x14, 0xc7, 0x45, 0xf8, 0x00, 0x00, 0x00, 0x00, 0xeb, 0x79, 0x8b, 0x45, 0xf8, 0x48, 0x63, 0xd0, 0x48, 0x8b, 0x45, 0xe8, 0x48, 0x01, 0xd0, 0x0f, 0xb6, 0x00, 0x83, 0xe0, 0xf0, 0x88, 0x45, 0xf7, 0x8b, 0x45, 0xf8, 0x48, 0x63, 0xd0, 0x48, 0x8b, 0x45, 0xe8, 0x48, 0x01, 0xd0, 0x0f, 0xb6, 0x00, 0x0f, 0xbe, 0xc0, 0xc1, 0xe0, 0x04, 0x89, 0xc6, 0x0f, 0xb6, 0x45, 0xf7, 0xc0, 0xe8, 0x04, 0x89, 0xc1, 0x8b, 0x45, 0xf8, 0x48, 0x63, 0xd0, 0x48, 0x8b, 0x45, 0xe8, 0x48, 0x01, 0xd0, 0x09, 0xce, 0x89, 0xf2, 0x88, 0x10, 0x8b, 0x45, 0xf8, 0x48, 0x63, 0xd0, 0x48, 0x8b, 0x45, 0xe8, 0x48, 0x01, 0xd0, 0x0f, 0xb6, 0x00, 0x89, 0xc2, 0x8b, 0x45, 0xe4, 0x01, 0xd0, 0x8d, 0x48, 0x23, 0x8b, 0x45, 0xf8, 0x48, 0x63, 0xd0, 0x48, 0x8b, 0x45, 0xe8, 0x48, 0x01, 0xd0, 0x89, 0xca, 0x88, 0x10, 0x83, 0x45, 0xf8, 0x01, 0x83, 0x7d, 0xf8, 0x1c, 0x7e, 0x81, 0xc7, 0x45, 0xfc, 0x00, 0x00, 0x00, 0x00, 0xe9, 0xb1, 0x00, 0x00, 0x00, 0x8b, 0x45, 0xfc, 0x48, 0x63, 0xd0, 0x48, 0x8b, 0x45, 0xe8, 0x48, 0x01, 0xd0, 0x0f, 0xb6, 0x30, 0xb8, 0x1c, 0x00, 0x00, 0x00, 0x2b, 0x45, 0xfc, 0x48, 0x63, 0xd0, 0x48, 0x8b, 0x45, 0xe8, 0x48, 0x01, 0xd0, 0x0f, 0xb6, 0x08, 0x8b, 0x45, 0xfc, 0x48, 0x63, 0xd0, 0x48, 0x8b, 0x45, 0xe8, 0x48, 0x01, 0xd0, 0x31, 0xce, 0x89, 0xf2, 0x88, 0x10, 0xb8, 0x1c, 0x00, 0x00, 0x00, 0x2b, 0x45, 0xfc, 0x48, 0x63, 0xd0, 0x48, 0x8b, 0x45, 0xe8, 0x48, 0x01, 0xd0, 0x0f, 0xb6, 0x30, 0x8b, 0x45, 0xfc, 0x48, 0x63, 0xd0, 0x48, 0x8b, 0x45, 0xe8, 0x48, 0x01, 0xd0, 0x0f, 0xb6, 0x08, 0xb8, 0x1c, 0x00, 0x00, 0x00, 0x2b, 0x45, 0xfc, 0x48, 0x63, 0xd0, 0x48, 0x8b, 0x45, 0xe8, 0x48, 0x01, 0xd0, 0x31, 0xce, 0x89, 0xf2, 0x88, 0x10, 0x8b, 0x45, 0xfc, 0x48, 0x63, 0xd0, 0x48, 0x8b, 0x45, 0xe8, 0x48, 0x01, 0xd0, 0x0f, 0xb6, 0x30, 0xb8, 0x1c, 0x00, 0x00, 0x00, 0x2b, 0x45, 0xfc, 0x48, 0x63, 0xd0, 0x48, 0x8b, 0x45, 0xe8, 0x48, 0x01, 0xd0, 0x0f, 0xb6, 0x08, 0x8b, 0x45, 0xfc, 0x48, 0x63, 0xd0, 0x48, 0x8b, 0x45, 0xe8, 0x48, 0x01, 0xd0, 0x31, 0xce, 0x89, 0xf2, 0x88, 0x10, 0x83, 0x45, 0xfc, 0x01, 0x83, 0x7d, 0xfc, 0x0d, 0x0f, 0x8e, 0x45, 0xff, 0xff, 0xff, 0x90, 0x90, 0x5d, 0xc3}; 
    for(int i = 0; i < sizeof(code); i++) {
        code[i] = code[i] - 0x5;
        uint8_t lower2 = 0xc0 & code[i];
        code[i] = (code[i] << 2) | (lower2 >> 6);
        code[i] ^= 0x37;
        printf("0x%x,", (unsigned char)code[i]);
    }
    printf("};\n");
    
}